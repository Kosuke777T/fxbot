ミチビキ ToDoリスト v4（正式版）

（仕様書 v4 に完全準拠）


ミチビキ v4 の ToDo は A/B/C/D の4ブロック に整理されます。
順番は “安全運用 → UI → スケジューラ → ランキング” の流れに最適化。

A：3％KPIに必要なAI・バックテスト基盤（コア）

ミチビキの “性能そのもの” を規定する基礎パート。
既存の A1〜A7 を v4 向けに調整して再構成したもの。

A1：バックテスト結果に必ず monthly_returns.csv を出力

全てのストラテジー/全期間で月次リターンを出力することを保証

Expert のランキング機能の基礎データになる

A2：基準ストラテジー（WFO + ATR 仕様）を1つ確定

「ミチビキ標準設定」＝Pro/Expertのデモ動作で利用するモデル

AIタブのKPI計算の標準化にも使う

A3：月次目標（3％）を利用するロット＆リスク管理ロジック

target_monthly_return

max_monthly_dd

monthly_vol_target

これら 3パラメータでロット公式を自動調整

A4：AIタブの “月次3％ダッシュボード” を完成

KPI：今月損益％ / PF / DD / 連勝/連敗

モデル情報：AUC / Logloss / バージョン

月次リターン折れ線（Expertで拡張）

Pro：FI20 / SHAP3

Expert：FI全件 / SHAP20

A5：バックテスト診断AI（時間帯 × 相場タイプ）v0

Pro：簡易診断（時間帯/相場）

Expert：連敗区間・DD直前特徴・異常点抽出・勝率高い相場特徴など

A6：MT5発注ラッパーの完成 ＋ 1ヶ月デモ運用ログ

MT5Clientの安定化

発注テスト（デモ）を1ヶ月運用して挙動確認

A7：本番運用チェックリスト（docs/production_checklist.md）

本口座移行前の確認点をまとめる

B：日本語UI化 & エディション制御（v4対応）

仕様書 v4 の中核である “Free/Basic/Pro/Expert/Master” を機能的に実装する領域。

B1：日本語UIフル対応

全タブの日本語化（設定/AI/ランキング/ログ/スケジューラ）

文字化け修正（UTF-8 BOMなし）

ログメッセージも日本語中心に統一

B2：EditionGuard（エディション制御クラス）

各 edition が以下を制御：

接続可能口座（デモのみ / 本口座OK）

ロット上限

AIタブ表示（KPIのみ / FI / SHAP）

スケジューラ編集可否

ランキング送信可否

フィルタ設定（簡易 / 複合）

B3：ランキング機能 v0（ローカルモックサーバ）

RankingService の実装

local JSON で mock サーバとして動作

エディション別のランキングテーブル

Free：閲覧のみ

Basic：送信可

Pro：Pro専用ランキング

Expert：複合スコア（Return×DD×PF）表示

B4：ミチビキ用 UI の最終調整

ランキングタブ

AIタブのタブ化（KPI / FI / SHAP / 診断）

スケジューラ設定画面

C：内蔵 JobScheduler（タスクスケジューラ不要化）

ミチビキ v4 最大の変更点。
Windowsタスクスケジューラは使わずミチビキ内で完結。

C1：JobScheduler（常駐スレッド）基礎クラス

30〜60秒間隔で時刻チェック

ジョブの last_run_at を持ち二重実行防止

実行履歴を logs/scheduler.log に記録

C2：config.scheduler.yaml を正式採用

edition_min

weekday/hour/minute

command

Basic では ON/OFF だけ編集可

C3：GUIのスケジューラ編集UI

Free：表示のみ
Basic：ON/OFFのみ
Pro：1つジョブ編集可能
Expert：複数ジョブ、連鎖（再学習→診断→整理）

C4：週次再学習の実働テスト

2分後などのテスト時刻を設定し、
→ python -m scripts.walkforward_retrain が実際に起動することを確認

C5：旧Windowsタスクスケジューラスクリプトの廃止

scripts/legacy に移動し “非推奨” と明記

D：エディション別のバックテスト・フィルタ設定

ミチビキ v4 追加分。運用モジュールの深い設定。

D1：Proフィルタ

時間帯フィルタ（使える）

ATRオン/オフ

簡易フィルタ UI

D2：Expertフィルタ

複合フィルタ（ATR×ボラ×時間帯×トレンド）

連敗回避モード

自動プロファイル切替

戦略のボラ帯最適化

D3：フィルタのバックテスト反映

backtests/{profile}/analyze.json に各フィルタ条件を保存

E：販売準備（UI・ライセンス・バージョン表示）

これはミチビキとして必要になる “製品化” 領域。

E1：ライセンス認証（簡易版）

edition の切替をファイル/キー/APIで行う

E2：アプリの About 画面

ミチビキのロゴ

バージョン番号

edition 表示

更新ログリンク

E3：インストーラ準備（最終段階）

Windows 用の配布形式（PyInstaller または Briefcase）

ディレクトリ構成の凍結

🔥 全体の進行順（推奨）

A：月次3％の基礎（AI/バックテスト/MT5）

B：日本語UI ＋ エディション制御

C：内蔵スケジューラ

D：Expert向け高度設定

E：販売準備（ライセンス/インストーラ）