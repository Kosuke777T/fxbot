ミチビキ FX 自動売買システム：仕様書 v4（正式版）

2025 / Windows版（PyQt6 GUI）

0. 目的・ターゲット
■ 目的

MT5（MetaTrader5）を用い、
「月間＋3％前後のリターンを目指す」AI自動売買システムを構築する。

・月間3%は義務ではなく KPI（目標値）
・最大ドローダウンは -15〜-20％以内 を安全圏とする
・Walk-Forward 再学習、特徴量可視化、ランキングなどの分析基盤を内蔵する

ミチビキは
裁量 → 半自動 → 自動
へ移行したい個人トレーダー向けの「運用支援ソフト」。

■ ターゲットユーザー

・Windows (10/11)
・日本語環境
・MT5ユーザー
・初心者〜上級者まで
・AI分析＋自動売買に興味がある人

1. 全体アーキテクチャ

3レイヤ構造で設計する。

1) GUI 層（app.gui）

・PyQt6 ベース
・メイン画面、AIタブ、ランキングタブ、スケジューラ設定、ログビューアを含む

2) サービス層（app.services）

・AIサービス（AISvc）
・KPI計算
・Feature Importance / SHAP
・JobScheduler（内蔵スケジューラ）
・RankingService
・ログ出力

3) コア層（app.core）

・MT5ラッパー
・戦略ロジック
・バックテストエンジン
・データローダ
・モデル管理

2. 実行形態
● GUIアプリとして起動（通常モード）
● 将来的に「タスクトレイ常駐モード」へ拡張可能
3. データ構造（共通フォルダ）
config/                 設定ファイル  
models/                 学習済みモデル  
logs/                   ログ、決定ログ  
backtests/{profile}/    バックテスト結果  

4. エディション構成（v4）

v3の構造に基づきつつ、Pro→Expertの差を強化して Expert ユーザー比率を最大化するよう最適化。

■ 共通ルール

・実行ファイルは全エディション共通
・機能差は edition: free/basic/pro/expert/master フラグで制御
・ライセンス認証または設定ファイルで決定

◆ 各エディション詳細（v4）
🔥 Free（無料版）
目的

お試し用。ユーザーを入り口に誘導する。

機能

・デモ口座のみ
・自動売買：可能（ロット制限）
・AIタブ：KPIのみ（勝率、今月損益％、PF 等）
・Feature Importance / SHAP：非表示
・ランキング：閲覧のみ（送信不可）
・スケジューラ：画面表示のみ（設定不可／OFF固定）

🔥 Basic（有料ライト版）
用途

初心者向けの本口座運用。

月額想定：2,480円前後
機能

・本口座対応
・単一プロファイルのみ
・ランキング送信（Basicテーブル）
・AIタブ：
　- KPI
　- 月間リターン簡易表示
・スケジューラ：
　- 週1再学習（曜日・時刻は固定）
　- ON/OFFのみ可能
・FI/SHAP：表示なし

🔥 Pro（中級者版：便利だが“あと少し足りない”設計）
月額想定：6,480円前後
コンセプト

SHAP / 分析が使えるが、「勝率に直結する深い設定」が不足するように意図的に設計

機能

・複数プロファイルに対応
・Feature Importance：Top20
・SHAP：Top3 まで
・スケジューラ：
　- 同時に 1 ジョブのみ
　- 再学習 or 診断レポート のどちらか
・ランキング：
　- Pro専用ランキング
　- リターン％のみ
・フィルタ：
　- 時間帯フィルタ
　- ATRの単純しきい値（オンオフ）
・バックテスト診断AI：
　- 時間帯 × 相場タイプの基本分析のみ

→ 十分に使えるが “Expertが欲しくなる” 位置付け

🔥 Expert（最上位版：勝率に直結する全機能を装備）
月額想定：8,980円前後

（Proとの差を2,500円以内にするのが心理的に重要）

コンセプト

“勝率向上に関わる設定はすべてExpertに集約”
ユーザーが最も選ぶ階層を意図的に作る。

機能

・複合フィルタ（ATR × ボラ × 時間帯 × トレンド強度）
・連敗回避モード
・勝率高いプロファイルの自動切り替え
・Feature Importance：全件
・SHAP：Top20（または全体）
・バックテスト診断AI（完全版）：
　- DD直前の特徴
- 連勝区間特徴
- 勝率上昇の相場条件抽出
- 損益曲線の異常点の検出
・スケジューラ：
- 複数ジョブ（再学習＋診断＋ログ整理など）
- 自動ジョブ連鎖
- 月次自動運用テンプレ
・ランキング：
- Expert専用複合スコア（リターン×DD×PF）
- 過去履歴の完全同期
- 自動送信 ON/OFF 可能

→ 実運用者のほぼ全員が選ぶ階層（狙い通り Expert 5割に寄る）

🔥 Master（開発者版）

一般販売なし。
全機能解放。
ランキングサーバ設定、APIキー、検証用ツールすべて使用可能。

5. JobScheduler（内蔵スケジューラ）
■ 基本仕様

・Windowsタスクスケジューラは使用しない
・アプリ内で
　- 時刻管理
　- ジョブ管理
　- 実行履歴
　を完結させる

■ v4エディション差分
Free

・表示のみ／機能は無効

Basic

・週1再学習（固定時刻）
・ON/OFFのみ

Pro

・ジョブを1つだけ登録可能
・再学習 OR 診断AI のどちらかのみ選択可
・詳細ログなし（簡易ログ）

Expert

・複数ジョブ
・ジョブ連鎖（例：再学習→診断→最適プロファイル切替）
・詳細ログ
・毎週／毎日／月末処理が可能
・ログ圧縮、バックアップもジョブ化できる

6. AIタブ（KPI / Feature Importance / SHAP / 診断）
■ Pro

・KPI
・FI Top20
・SHAP Top3
・基本診断（時間帯×相場タイプ）

■ Expert

・KPI
・FI 全件
・SHAP Top20
・高度診断
　- DD直前特性
- 連勝区間
- 勝率高い相場特徴
- 損益曲線の異常点
- 来週の簡易予測（Expert限定）

7. フィルタ設定
■ Pro

・時間帯フィルタ
・ATR オンオフ
・簡易フィルタのみ

■ Expert

・複合フィルタ（ATR × ボラ × 時間帯 × トレンド）
・連敗回避
・勝率高いプロファイル自動切替
・ボラ帯ごとの戦略最適化

8. ランキング（任意機能）
■ Basic

・Basicランキング送信
・閲覧可

■ Pro

・Proランキング
・リターン％のみ
・手動送信

■ Expert

・Expert複合スコア
・過去履歴がサーバに保存
・自動送信ON/OFF
・複合スコア（リターン×DD×PF）

9. 日本語仕様

・UI・メッセージはすべて日本語
・ログは日本語＋簡易英語併記
・文字コード UTF-8（BOMなし）

10. 付録：推奨価格モデル（v4）
Basic：2,480円/月  
Pro：6,480円/月  
Expert：8,980円/月  
初期費用（買い切り）：9,800〜29,800円  


※ProとExpertの差を小さくすることで
　Expert比率を約50%に誘導できる。